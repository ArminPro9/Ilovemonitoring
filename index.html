<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dynamic Data Table</title>
    <style>
        .yellow {
            background-color: yellow;
        }
        .red {
            background-color: red;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            function fetchData() {
                fetch('/data')
                    .then(response => response.json())
                    .then(data => {
                        const tableBody = document.getElementById('table-body');
                        tableBody.innerHTML = '';
                        data.forEach(row => {
                            const tr = document.createElement('tr');

                            // Determine the row color based on the conditions
                            const northingStdDiv = row.Northing_StdDiv;
                            const eastingStdDiv = row.Easting_StdDiv;
                            const elevationStdDiv = row.Elevation_StdDiv;

                            let isYellow = (
                            Math.abs(northingStdDiv) + Math.abs(eastingStdDiv) + Math.abs(elevationStdDiv) > 0.004 && 
                            Math.abs(northingStdDiv) + Math.abs(eastingStdDiv) + Math.abs(elevationStdDiv) < 0.011
                            );

                            let isRed = (
                            Math.abs(northingStdDiv) + Math.abs(eastingStdDiv) + Math.abs(elevationStdDiv) > 0.011
                            );

                            if (isRed) {
                                tr.classList.add('red');
                            } else if (isYellow) {
                                tr.classList.add('yellow');
                            }

                            // Append table cells for each column
                            Object.values(row).forEach((cellValue, index) => {
                                const td = document.createElement('td');
                                td.textContent = cellValue;
                                tr.appendChild(td);
                            });

                            tableBody.appendChild(tr);
                        });
                    });
            }

            fetchData();
        });
    </script>
</head>
<body>
    <h1>Dynamic Data Table</h1>
    <table border="1">
        <thead>
            <tr>
                <th>Event Time</th>
                <th>Point Name</th>
                <th>Northing StdDiv</th>
                <th>Easting StdDiv</th>
                <th>Elevation StdDiv</th>
                <th>Visible</th>
                <th>Total shot</th>
            </tr>
        </thead>
        <tbody id="table-body">
            <!-- Data will be inserted here -->
        </tbody>
    </table>
</body>
</html>
